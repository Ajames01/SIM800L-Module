# DHT11 to ThingSpeak via GPRS (No WiFi)

[![Arduino](https://img.shields.io/badge/Arduino-Compatible-00979D?style=flat&logo=arduino)](https://www.arduino.cc/)
[![ESP32](https://img.shields.io/badge/ESP32-Compatible-E7352C?style=flat&logo=espressif)](https://www.espressif.com/)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)

This project provides complete code and setup instructions for logging environmental data (Temperature and Humidity) from a DHT11 sensor to the ThingSpeak IoT platform using the SIM800L GSM moduleâ€™s GPRS connection.

## âš™ï¸ Prerequisites

### Hardware Requirements

- Arduino Uno/Mega or ESP32
- SIM800L GSM module
- DHT11 temperature and humidity sensor
- Active SIM card with data plan
- Appropriate power supply (SIM800L requires stable 3.7-4.2V, 2A)

### Software Requirements

Install the following libraries in your Arduino IDE:

- **DHT.h** (from Adafruit or similar source)
- **SoftwareSerial.h** (standard with Arduino IDE, needed for Uno)

### ThingSpeak Setup

1. Create a [ThingSpeak](https://thingspeak.com/) account
1. Create a new channel with two fields:

- **Field 1**: Temperature
- **Field 2**: Humidity

1. Obtain your Channelâ€™s **Write API Key**

## ğŸ› ï¸ Configuration

Update the following constants in the code with your specific details:

|Constant   |Description                            |Example Value                        |
|-----------|---------------------------------------|-------------------------------------|
|`APN`      |Your mobile carrierâ€™s Access Point Name|`"internet"` or `"data.globe.com.ph"`|
|`APN_USER` |APN Username (often blank, use `""`)   |`""`                                 |
|`apiKey`   |Your ThingSpeak Channel Write API Key  |`"YOUR_KEY_HERE"`                    |
|`DHTPIN`   |DHT11 sensor data pin                  |`13` (ESP32) or `2` (Arduino)        |
|Serial pins|RX/TX pins for SIM800L                 |`16/17` (ESP32) or `2/3` (Arduino)   |

## ğŸ”Œ Hardware Connections

### ESP32 to SIM800L

|ESP32 Pin   |SIM800L Pin|
|------------|-----------|
|GPIO 16 (RX)|TX         |
|GPIO 17 (TX)|RX         |
|GND         |GND        |
|3.7-4.2V    |VCC        |

### ESP32 to DHT11

|ESP32 Pin|DHT11 Pin|
|---------|---------|
|GPIO 13  |DATA     |
|3.3V     |VCC      |
|GND      |GND      |


> **âš ï¸ Important**: Ensure proper power supply for SIM800L. Use a separate power source capable of delivering 2A during transmission bursts.

## ğŸ’» Installation

1. Clone this repository:

```bash
git clone https://github.com/yourusername/dht11-thingspeak-gprs.git
cd dht11-thingspeak-gprs
```

1. Open `sim800l_dht_thingspeak.ino` in Arduino IDE
1. Update configuration constants:

- `apiKey` - Your ThingSpeak Write API Key
- `apn` - Your carrierâ€™s APN
- Pin definitions if using different pins

1. Upload to your board

## ğŸ“Š How It Works

The code uses a state machine approach to reliably handle the complete GPRS connection and data upload process:

1. **AT Communication Check** - Verifies SIM800L is responsive
1. **SIM Card Validation** - Ensures SIM card is detected and unlocked
1. **Network Registration** - Waits for cellular network connection
1. **GPRS Attachment** - Attaches to GPRS service
1. **Bearer Setup** - Configures GPRS bearer profile with APN
1. **Bearer Activation** - Opens GPRS connection and obtains IP
1. **HTTP Initialization** - Prepares HTTP client
1. **Sensor Reading** - Reads temperature and humidity from DHT11
1. **URL Construction** - Builds ThingSpeak API request
1. **HTTP Request** - Sends data to ThingSpeak
1. **Response Processing** - Handles server response
1. **Cleanup** - Terminates HTTP session
1. **Wait Cycle** - Delays 20 seconds before next reading

## ğŸ”§ Troubleshooting

### Common Issues

**SIM800L not responding:**

- Check power supply (needs stable 3.7-4.2V, 2A capability)
- Verify RX/TX connections (they should be crossed)
- Ensure proper grounding

**Network registration fails:**

- Check SIM card is activated and has data plan
- Verify signal strength with `AT+CSQ` command
- Try different antenna or location

**GPRS connection fails:**

- Verify APN settings for your carrier
- Ensure SIM has active data subscription
- Check if APN username/password needed

**HTTP request timeout:**

- Verify ThingSpeak API key is correct
- Check internet connectivity
- Ensure bearer profile is properly configured

**Sensor reads NaN:**

- Verify DHT11 connections
- Check DHT11 power supply (3.3V or 5V depending on module)
- Add 10kÎ© pull-up resistor to data line if needed

## ğŸ“ˆ Serial Monitor Output

Expected output when running successfully:

```
=== ESP32 + SIM800L + ThingSpeak (HTTP Method) ===

[STEP 1] Testing AT communication...
âœ“ SUCCESS

[STEP 2] Checking SIM card status...
âœ“ SUCCESS

[STEP 3] Checking network registration...
âœ“ Registered on network!

...

[STEP 10] Reading DHT11 sensor...
Temperature: 25.30 Â°C
Humidity: 60.20 %
âœ“ Sensor data read successfully

[STEP 12] Executing HTTP GET request...
âœ“âœ“âœ“ HTTP 200 OK - DATA SENT SUCCESSFULLY! âœ“âœ“âœ“
```

## ğŸŒ Common APN Settings

|Carrier |Country    |APN                      |
|--------|-----------|-------------------------|
|MTN     |Nigeria    |`web.gprs.mtnnigeria.net`|
|Globe   |Philippines|`data.globe.com.ph`      |
|Smart   |Philippines|`internet`               |
|Airtel  |India      |`airtelgprs.com`         |
|Vodafone|UK         |`pp.vodafone.co.uk`      |
|T-Mobile|USA        |`fast.t-mobile.com`      |
|AT&T    |USA        |`phone`                  |

*Contact your carrier for specific APN settings.*

## ğŸ“ License

This project is open source and available under the MIT License.

## ğŸ¤ Contributing

Contributions, issues, and feature requests are welcome! Feel free to check the [issues page](../../issues).

## ğŸ™ Acknowledgments

- Adafruit for the DHT sensor library
- ThingSpeak for the IoT platform
- SIMCom for SIM800L documentation

## ğŸ“§ Support

If you have questions or need help:

- Open an [issue](../../issues)
- Check existing [discussions](../../discussions)

-----

**âš ï¸ Security Note**: Keep your ThingSpeak API key private. Never commit credentials to public repositories. Consider using environment variables or a separate config file thatâ€™s added to `.gitignore`.

-----

**Made with â¤ï¸ for IoT enthusiasts**
